// Generated by CoffeeScript 1.8.0
(function() {
  var gems, meetupApp,
    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

  meetupApp = angular.module('meetupApp', ['google-maps']);

  meetupApp.factory('locationService', function() {
    this.geocoder = new google.maps.Geocoder();
    this.processLocation = function(location, locations) {
      return this.geocoder.geocode({
        address: location
      }, function(results, status) {
        if (status === google.maps.GeocoderStatus.OK) {
          return locations.push(results[0]);
        } else {
          return alert("Failed!  Status: " + status);
        }
      });
    };
    this.locations = [];
    this.getLocations = function() {
      return this.locations;
    };
    this.addLocation = function(location) {
      if (location && __indexOf.call(this.locations, location) < 0) {
        return this.processLocation(location, this.locations);
      }
    };
    return {
      locations: this.locations,
      getLocations: this.getLocations,
      addLocation: this.addLocation,
      processLocation: this.processLocation,
      geocoder: this.geocoder
    };
  });

  meetupApp.controller('MeetupController', function($scope, locationService) {
    this.products = gems;
    return this.locations = locationService.getLocations();
  });

  meetupApp.controller('LocationEntryController', function($scope, locationService) {
    this.location;
    return this.addLocation = function() {
      locationService.addLocation(this.location);
      return this.location = "";
    };
  });

  meetupApp.controller('MapController', function() {
    this.map = {
      center: {
        latitude: 45,
        longitude: -73
      },
      zoom: 7
    };
    this.buildIcon = function(iconURL) {
      return {
        anchor: new google.maps.Point(16, 32),
        size: new google.maps.Size(32, 32),
        url: iconURL
      };
    };
    return this.icons = {
      location: this.buildIcon("https://maps.google.com/mapfiles/ms/icons/blue-dot.png"),
      between: this.buildIcon("https://maps.google.com/mapfiles/ms/icons/green-dot.png"),
      search: this.buildIcon("https://maps.google.com/mapfiles/ms/icons/yellow-dot.png")
    };
  });

  gems = [
    {
      name: 'Dodecahedron',
      price: 2.95,
      description: 'Here is some nonsensical description text',
      reviews: [],
      canPurchase: true,
      soldOut: true
    }, {
      name: 'Pentagonal Gem',
      price: 5.95,
      description: 'Different descriptive text',
      reviews: [],
      canPurchase: true,
      soldOut: false
    }, {
      name: 'Something new',
      price: 4.95,
      description: 'Poo dollar',
      reviews: [
        {
          stars: 5,
          body: "I love this product!",
          author: "phil@shutterfly.com"
        }
      ],
      canPurchase: true,
      soldOut: false
    }
  ];

  meetupApp.controller('PanelController', function() {
    this.tab = 1;
    this.selectTab = function(setTab) {
      return this.tab = setTab;
    };
    return this.isSelected = function(checkTab) {
      return this.tab === checkTab;
    };
  });

  meetupApp.controller('ReviewController', function() {
    this.review = {};
    return this.addReview = function(address) {
      address.reviews.push(this.review);
      return this.review = {};
    };
  });

}).call(this);
