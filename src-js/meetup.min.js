(function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++){if(t in this&&this[t]===e)return t}return-1};e=angular.module("meetupApp",["AngularGM","ngGPlaces","ngAutocomplete"]);e.factory("locationService",function(){this.geocoder=new google.maps.Geocoder;this.searcher=new google.maps.places.PlacesService(document.getElementById("results"));this.processLocation=function(e){return function(t,n,r){return e.geocoder.geocode({address:t,location:n},function(e,t){if(t===google.maps.GeocoderStatus.OK){return r(e[0])}else if(t===google.maps.GeocoderStatus.ZERO_RESULTS){return alert("Location not found!  Please try again, or add a different location.")}else if(t===google.maps.GeocoderStatus.OVER_QUERY_LIMIT){return alert("Website is over query limit.  Please contact me at philip.t.jenkins@gmail.com")}else if(t===google.maps.GeocoderStatus.REQUEST_DENIED){return alert("Request denied.  Please contact me at philip.t.jenkins@gmail.com")}else{return alert("Unknown Error.  Please check your internet connection and try again.")}})}}(this);this.performSearch=function(e){return function(t,n,r){return e.searcher.textSearch({query:n,location:t,radius:5},function(e,t,n){if(t===google.maps.places.PlacesServiceStatus.OK){return r(e,n)}else if(t===google.maps.places.PlacesServiceStatus.ZERO_RESULTS){return alert("No results found!  Please enter a different search term.")}else if(t===google.maps.places.PlacesServiceStatus.INVALID_REQUEST){return alert("Invalid request.  Please check search term and try again.")}else if(t===google.maps.places.PlacesServiceStatus.OVER_QUERY_LIMIT){return alert("Website is over query limit.  Please contact me at philip.t.jenkins@gmail.com")}else if(t===google.maps.GeocoderStatus.REQUEST_DENIED){return alert("Request denied.  Please contact me at philip.t.jenkins@gmail.com")}else{return alert("Unknown Error.  Please check your internet connection and try again.")}})}}(this);this.getLocationDetails=function(e){return function(t,n){return e.searcher.getDetails({placeId:t},function(e,t){if(t!==google.maps.places.PlacesServiceStatus.OK){console.log("error fetching location details.");return}return n(e)})}}(this);return{processLocation:this.processLocation,performSearch:this.performSearch,getLocationDetails:this.getLocationDetails}});e.controller("MeetupController",["$scope","locationService",function(e,n){this.locationMarkers=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];this.clickDisablingNodes=["SELECT","A","INPUT"];this.locations=[];this.bounds=new google.maps.LatLngBounds;this.centerOfSearchArea;this.locationFormEntry;this.searchTerm="coffee";this.markerEvents;this.searchPages=[];this.searchPageIndex=0;this.searchPaginationObject;this.processLocationFormEntry=function(){if(this.locationFormEntry){n.processLocation(this.locationFormEntry,this.centerOfSearchArea,this.addLocation)}return this.locationFormEntry=""};this.addLocation=function(t){return function(n){if(!t.locationAlreadyEntered(n)){t.locations.push(n);t.updateMapLocations();t.performSearch();return e.$apply()}}}(this);this.locationAlreadyEntered=function(e){var t,n,r,i;i=this.locations;for(n=0,r=i.length;n<r;n++){t=i[n];if(t.formatted_address===e.formatted_address){return true}}return false};this.removeLocation=function(e){this.locations.splice(this.locations.indexOf(e),1);this.updateMapLocations();return this.performSearch()};this.updateMapLocations=function(e){return function(){var t,n,r,i;if(e.locations.length>0){e.bounds=new google.maps.LatLngBounds;i=e.locations;for(n=0,r=i.length;n<r;n++){t=i[n];e.bounds.extend(t.geometry.location)}}return e.centerOfSearchArea=e.bounds.getCenter()}}(this);this.updateMapSearchResults=function(e){return function(){var t,n,r,i,s,o,u,a,f;if(e.getDisplayedResults().length>0){e.bounds=new google.maps.LatLngBounds;u=e.locations;for(r=0,s=u.length;r<s;r++){t=u[r];e.bounds.extend(t.geometry.location)}a=e.getDisplayedResults();f=[];for(i=0,o=a.length;i<o;i++){n=a[i];f.push(e.bounds.extend(n.geometry.location))}return f}}}(this);this.updateSearchArea=function(e,t){this.centerOfSearchArea=t.getPosition();return this.performSearch()};this.performSearch=function(t){return function(){t.searchPages=[];t.searchPageIndex=0;if(!t.searchTerm||t.locations.length===0){e.$broadcast("gmMarkersUpdate","meetup.getDisplayedResults()");return}return n.performSearch(t.centerOfSearchArea,t.searchTerm,t.displayResults)}}(this);this.displayResults=function(t){return function(n,r){t.searchPaginationObject=r;t.searchPages.push(n.slice(0,10));t.searchPages.push(n.slice(10));if(t.searchPages.length>2){t.searchPageIndex++}t.updateMapSearchResults();return e.$apply()}}(this);this.getDisplayedResults=function(){return this.searchPages[this.searchPageIndex]};this.addLocationDetail=function(t){return function(n){var r,i,s,o;o=t.getDisplayedResults();for(i=0,s=o.length;i<s;i++){r=o[i];if(r.place_id===n.place_id){r.reviews=n.reviews;r.formatted_phone_number=n.formatted_phone_number;r.url=n.url;r.website=n.website;r.opening_hours=n.opening_hours;break}}e.$apply();return e.$broadcast("gmMarkersUpdate","meetup.getDisplayedResults()")}}(this);this.getMapLocationOptions=function(e){return angular.extend(this.mapLocationOptions,{icon:"http://maps.google.com/mapfiles/marker_grey"+this.locationMarkers[this.locations.indexOf(e)]+".png"})};this.getMapSearchAreaOptions=function(){if(this.locations.length>0){return this.mapSearchAreaOptions}else{return this.mapHiddenMarkersOptions}};this.getMapSearchResultsOptions=function(e){return angular.extend(this.searchResultOptions,e.selected?this.markerSelectedIcon:e.highlighted?this.markerHighlightedIcon:this.markerDefaultIcon)};this.getLocationId=function(e){return this.locationMarkers[this.locations.indexOf(e)]};this.getBaseUrl=function(e){var t;if(e){t=e.split("/");return t[2]}};this.selectResult=function(t){var r,i,s,o;if(t.website===void 0){n.getLocationDetails(t.place_id,this.addLocationDetail)}o=this.getDisplayedResults();for(i=0,s=o.length;i<s;i++){r=o[i];r.selected=false}t.selected=true;return e.$broadcast("gmMarkersUpdate","meetup.getDisplayedResults()")};this.deSelectResult=function(t){t.selected=false;return e.$broadcast("gmMarkersUpdate","meetup.getDisplayedResults()")};this.highlightResult=function(t){t.highlighted=true;return e.$broadcast("gmMarkersUpdate","meetup.getDisplayedResults()")};this.unHighlightResult=function(t){t.highlighted=false;return e.$broadcast("gmMarkersUpdate","meetup.getDisplayedResults()")};this.toggleSelection=function(e){if(e.selected){this.deSelectResult(e);return this.triggerCloseInfoWindow(e)}else{this.selectResult(e);return this.triggerOpenInfoWindow(e)}};this.handleTextEntryClicked=function(e,n){var r;if(r=n.target.nodeName,t.call(this.clickDisablingNodes,r)>=0){}else{return this.toggleSelection(e)}};this.triggerOpenInfoWindow=function(e){return this.markerEvents=[{event:"openinfowindow",ids:["result"+e.formatted_address]}]};this.triggerCloseInfoWindow=function(e){return this.markerEvents=[{event:"closeinfowindow",ids:["result"+e.formatted_address]}]};this.getNormalizedAddress=function(e){var t;if(e){t=e.formatted_address;if(t.indexOf(", USA")>0){return t.substr(0,t.indexOf(", USA"))}else if(t.indexOf(", United States")>0){return t.substr(0,t.indexOf(", United States"))}else{return t}}};this.nextPageAvailable=function(){return this.searchPages.length-1>this.searchPageIndex||this.searchPaginationObject&&this.searchPaginationObject.hasNextPage};this.getSearchResultPageNumbers=function(){if(this.getDisplayedResults()){return this.searchPageIndex*10+1+" - "+(this.searchPageIndex*10+this.getDisplayedResults().length)}};this.getPreviousPage=function(){if(this.searchPageIndex>0){this.searchPageIndex--;return this.updateMapSearchResults()}};this.getNextPage=function(){if(this.searchPages.length-1>this.searchPageIndex){this.searchPageIndex++;return this.updateMapSearchResults()}else if(this.searchPaginationObject.hasNextPage){return this.searchPaginationObject.nextPage()}};this.getPageTitle=function(){if(window.location.host.indexOf("www.halfway")>=0){return"HalfwayHangout"}else{return"MidwayMeetup"}};this.getPageSubTitle=function(){if(window.location.host.indexOf("www.halfway")>=0){return"Where do you want to hang out?"}else{return"Where do you want to meet up?"}};this.markerSelectedIcon={icon:"https://maps.gstatic.com/mapfiles/ms2/micons/yellow-dot.png"};this.markerHighlightedIcon={icon:"http://labs.google.com/ridefinder/images/mm_20_yellow.png"};this.markerDefaultIcon={icon:"http://labs.google.com/ridefinder/images/mm_20_purple.png"};this.mapOptions={map:{center:new google.maps.LatLng(39,-95),zoom:4,mapTypeId:google.maps.MapTypeId.TERRAIN}};this.mapSearchAreaOptions={visible:true,draggable:true,icon:"http://maps.google.com/mapfiles/arrow.png"};this.mapLocationOptions={draggable:false};this.searchResultOptions={draggable:false,clickable:true};return this.mapHiddenMarkersOptions={visible:false}}]);e.controller("ResultListController",["$scope",function(e){this.getHoursForToday=function(e){var t,n,r,i;r=(new Date).getDay();if(e.opening_hours&&e.opening_hours.periods){n=e.opening_hours.periods[r];if(n){i=this.formatHours(n.open.hours)+":"+this.formatMinutes(n.open.minutes)+" "+this.getAMPM(n.open.hours);t=this.formatHours(n.close.hours)+":"+this.formatMinutes(n.close.minutes)+" "+this.getAMPM(n.close.hours);return i+" - "+t}else{return"Closed"}}};this.formatHours=function(e){if(e<13){return e}else{return e-12}};this.formatMinutes=function(e){if(e>10){return e}else{return e+"0"}};this.getAMPM=function(e){if(e<12){return"am"}else{return"pm"}};return this.getDirections=function(e,t){var n;console.log("from "+e+" to "+t);if(e&&t){n="http://maps.google.com/maps?saddr="+e.formatted_address+"&daddr="+t.formatted_address;console.log(n);window.open(n,"_blank")}return true}}])}).call(this)