(function(){var e,t=[].indexOf||function(e){for(var t=0,s=this.length;s>t;t++)if(t in this&&this[t]===e)return t;return-1};e=angular.module("meetupApp",["AngularGM","ngGPlaces"]),e.factory("locationService",function(){return this.geocoder=new google.maps.Geocoder,this.searcher=new google.maps.places.PlacesService(document.getElementById("results")),this.processLocation=function(e){return function(t,s,i){return e.geocoder.geocode({address:t,location:s},function(e,t){return t===google.maps.GeocoderStatus.OK?i(e[0]):alert("Failed!  Status: "+t)})}}(this),this.performSearch=function(e){return function(t,s,i){return e.searcher.textSearch({query:s,location:t,radius:5},function(e,t,s){return console.log("callback!"),t===google.maps.places.PlacesServiceStatus.ZERO_RESULTS?void alert("No results!"):i(e,s)})}}(this),this.getLocationDetails=function(e){return function(t,s){return e.searcher.getDetails({placeId:t},function(e,t){return t!==google.maps.places.PlacesServiceStatus.OK?void alert("Detail error!"):s(e)})}}(this),{processLocation:this.processLocation,performSearch:this.performSearch,getLocationDetails:this.getLocationDetails}}),e.controller("MeetupController",function(e,s,i){return this.locationMarkers=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],this.clickDisablingNodes=["SELECT","A","INPUT"],this.locations=[],this.bounds=new google.maps.LatLngBounds,this.centerOfSearchArea,this.formEntry,this.searchTerm="coffee",this.markerEvents,this.searchPages=[],this.searchPageIndex=0,this.searchPaginationObject,this.test=function(){return console.log("test executed")},this.processFormEntry=function(){return this.formEntry&&i.processLocation(this.formEntry,this.centerOfSearchArea,this.addLocation),this.formEntry=""},this.locationAlreadyEntered=function(e){var t,s,i,r;for(r=this.locations,s=0,i=r.length;i>s;s++)if(t=r[s],t.formatted_address===e.formatted_address)return!0;return!1},this.addLocation=function(t){return function(s){return t.locationAlreadyEntered(s)?void 0:(t.locations.push(s),t.updateMapLocations(),t.performSearch(),e.$apply())}}(this),this.removeLocation=function(e){return this.locations.splice(this.locations.indexOf(e),1),this.updateMapLocations(),this.performSearch()},this.updateMapLocations=function(e){return function(){var t,s,i,r;if(e.locations.length>0)for(e.bounds=new google.maps.LatLngBounds,r=e.locations,s=0,i=r.length;i>s;s++)t=r[s],e.bounds.extend(t.geometry.location);return e.centerOfSearchArea=e.bounds.getCenter()}}(this),this.updateMapSearchResults=function(e){return function(){var t,s,i,r,n,o,a,c,h;if(e.getDisplayedResults().length>0){for(e.bounds=new google.maps.LatLngBounds,a=e.locations,i=0,n=a.length;n>i;i++)t=a[i],e.bounds.extend(t.geometry.location);for(c=e.getDisplayedResults(),h=[],r=0,o=c.length;o>r;r++)s=c[r],h.push(e.bounds.extend(s.geometry.location));return h}}}(this),this.updateSearchArea=function(e,t){return this.centerOfSearchArea=t.getPosition(),this.performSearch()},this.performSearch=function(e){return function(){return e.searchPages=[],e.searchPageIndex=0,e.searchTerm&&0!==e.locations.length?i.performSearch(e.centerOfSearchArea,e.searchTerm,e.displayResults):void 0}}(this),this.displayResults=function(t){return function(s,i){return t.searchPaginationObject=i,t.searchPages.push(s.slice(0,10)),t.searchPages.push(s.slice(10)),t.searchPages.length>2&&t.searchPageIndex++,t.updateMapSearchResults(),e.$apply()}}(this),this.getDisplayedResults=function(){return this.searchPages[this.searchPageIndex]},this.addLocationDetail=function(t){return function(s){var i,r,n,o;for(o=t.getDisplayedResults(),r=0,n=o.length;n>r;r++)if(i=o[r],i.place_id===s.place_id){i.reviews=s.reviews,i.formatted_phone_number=s.formatted_phone_number,i.url=s.url,i.website=s.website,i.opening_hours=s.opening_hours;break}return e.$apply(),e.$broadcast("gmMarkersUpdate","meetup.getDisplayedResults()")}}(this),this.getMapLocationOptions=function(e){return angular.extend(this.mapLocationOptions,{icon:"http://maps.google.com/mapfiles/marker_grey"+this.locationMarkers[this.locations.indexOf(e)]+".png"})},this.getMapSearchAreaOptions=function(){return this.locations.length>0?this.mapSearchAreaOptions:this.mapHiddenMarkersOptions},this.getMapSearchResultsOptions=function(e){return angular.extend(this.searchResultOptions,e.selected?this.markerSelectedIcon:e.highlighted?this.markerHighlightedIcon:this.markerDefaultIcon)},this.getLocationId=function(e){return this.locationMarkers[this.locations.indexOf(e)]},this.getBaseUrl=function(e){var t;return e?(t=e.split("/"),t[2]):void 0},this.getHoursForToday=function(e){var t,s,i,r;return i=(new Date).getDay(),e.opening_hours&&e.opening_hours.periods?(s=e.opening_hours.periods[i],s?(r=this.formatHours(s.open.hours)+":"+this.formatMinutes(s.open.minutes)+" "+this.getAMPM(s.open.hours),t=this.formatHours(s.close.hours)+":"+this.formatMinutes(s.close.minutes)+" "+this.getAMPM(s.close.hours),r+" - "+t):"Closed"):void 0},this.formatHours=function(e){return 13>e?e:e-12},this.formatMinutes=function(e){return e>10?e:e+"0"},this.getAMPM=function(e){return 12>e?"am":"pm"},this.selectResult=function(t){var s,r,n,o;for(void 0===t.website&&i.getLocationDetails(t.place_id,this.addLocationDetail),o=this.getDisplayedResults(),r=0,n=o.length;n>r;r++)s=o[r],s.selected=!1;return t.selected=!0,e.$broadcast("gmMarkersUpdate","meetup.getDisplayedResults()")},this.deSelectResult=function(t){return t.selected=!1,e.$broadcast("gmMarkersUpdate","meetup.getDisplayedResults()")},this.highlightResult=function(t){return t.highlighted=!0,e.$broadcast("gmMarkersUpdate","meetup.getDisplayedResults()")},this.unHighlightResult=function(t){return t.highlighted=!1,e.$broadcast("gmMarkersUpdate","meetup.getDisplayedResults()")},this.toggleSelection=function(e){return e.selected?(this.deSelectResult(e),this.triggerCloseInfoWindow(e)):(this.selectResult(e),this.triggerOpenInfoWindow(e))},this.handleTextEntryClicked=function(e,s){var i;return i=s.target.nodeName,t.call(this.clickDisablingNodes,i)<0?this.toggleSelection(e):void 0},this.getDirections=function(e,t){var s;return console.log("from "+e+" to "+t),e&&t&&(s="http://maps.google.com/maps?saddr="+e.formatted_address+"&daddr="+t.formatted_address,console.log(s),window.open(s,"_blank")),!0},this.triggerOpenInfoWindow=function(e){return this.markerEvents=[{event:"openinfowindow",ids:["result"+e.formatted_address]}]},this.triggerCloseInfoWindow=function(e){return this.markerEvents=[{event:"closeinfowindow",ids:["result"+e.formatted_address]}]},this.getNormalizedAddress=function(e){var t;return e?(t=e.formatted_address,t.indexOf(", USA")>0?t.substr(0,t.indexOf(", USA")):t.indexOf(", United States")>0?t.substr(0,t.indexOf(", United States")):t):void 0},this.nextPageAvailable=function(){return this.searchPages.length-1>this.searchPageIndex||this.searchPaginationObject&&this.searchPaginationObject.hasNextPage},this.getSearchResultPageNumbers=function(){return this.getDisplayedResults()?10*this.searchPageIndex+1+" - "+(10*this.searchPageIndex+this.getDisplayedResults().length):void 0},this.getPreviousPage=function(){return this.searchPageIndex>0?(this.searchPageIndex--,this.updateMapSearchResults()):void 0},this.getNextPage=function(){return this.searchPages.length-1>this.searchPageIndex?(this.searchPageIndex++,this.updateMapSearchResults()):this.searchPaginationObject.hasNextPage?this.searchPaginationObject.nextPage():void 0},this.markerSelectedIcon={icon:"https://maps.gstatic.com/mapfiles/ms2/micons/yellow-dot.png"},this.markerHighlightedIcon={icon:"http://labs.google.com/ridefinder/images/mm_20_yellow.png"},this.markerDefaultIcon={icon:"http://labs.google.com/ridefinder/images/mm_20_purple.png"},this.mapOptions={map:{center:new google.maps.LatLng(39,-95),zoom:4,mapTypeId:google.maps.MapTypeId.TERRAIN}},this.mapSearchAreaOptions={visible:!0,draggable:!0,icon:"http://maps.google.com/mapfiles/arrow.png"},this.mapLocationOptions={draggable:!1},this.searchResultOptions={draggable:!1,clickable:!0},this.mapHiddenMarkersOptions={visible:!1}})}).call(this);